projectInfo:2131234545
  projectName: 智慧菜單規劃與意見調查系統
  executiveSummary: 一款整合 Google Sheets 作為後端、Google Apps Script 作為前端的菜單管理工具。它能將現有菜單匯入為結構化資料，並透過使用者意見調查來收集偏好，最終目標是結合 AI 分析與菜價爬蟲，提供智慧化的菜單建議。
  problemStatement: 餐廳或團體膳食管理者在規劃菜單時，缺乏有效的工具來收集使用者偏好，且難以系統化地管理菜色清單。手動整理菜單費時費力，也無法有效避免菜色重複或考量成本。
  targetUsers: 負責學校、企業或餐廳菜單規劃的管理者，以及希望對菜色有發言權的終端使用者（如學生、員工、顧客）。
  solutionVision: 打造一個輕量、易用的菜單管理與決策輔助系統。初期透過自動化匯入和使用者投票來簡化流程，未來擴展至 AI 驅動的智慧菜單推薦，幫助管理者在滿足使用者偏好的同時，也能控制成本。
  successMetrics:
    - "指標一：管理者能在 5 分鐘內，成功將一份現有菜單匯入系統並建立一份調查表。"
    - "指標二：上線一個月後，目標群體的使用者投票率達到 70% 以上。"
    - "指標三：透過系統收集到的回饋，下一個週期的菜單滿意度提升 15%。"
architecture:
  techStack:
    - component: 前端 (Frontend)
      technology: Google Apps Script (HTML Service)
      description: 用於生成管理者後台介面與使用者投票介面。
    - component: 後端 (Backend)
      technology: Google Apps Script (Code.gs)
      description: 處理所有業務邏輯，包括資料匯入、讀寫 Google Sheets、處理投票數據等。
    - component: 資料庫 (Database)
      technology: Google Sheets
      description: 儲存所有結構化菜單資料、使用者投票記錄、以及系統設定。
  systemDiagram: |
    graph TD
        subgraph "使用者端"
            A[使用者投票介面 (HTML)] -->|提交投票| B(Google Apps Script API)
        end
        subgraph "管理者端"
            C[管理後台 (HTML)] -->|1. 上傳菜單檔案| B
            C -->|2. 建立調查表| B
            C -->|3. 查看投票結果| B
        end
        subgraph "後端邏輯"
            B -->|讀寫資料| D[Google Sheets]
        end
        subgraph "資料庫"
            D -- "工作表1: 完整菜單資料庫 (Menu Master)"
            D -- "工作表2: 當期調查菜色 (Current Survey)"
            D -- "工作表3: 投票記錄 (Voting Records)"
        end

requirements:
  inScope:
    - 核心匯入功能：管理者能將特定格式的現有菜單，成功匯入到 Google Sheets 並轉為結構化資料。
    - 調查表建立與發布：管理者能從匯入的菜色清單中，挑選主菜與副菜，建立一份新的意見調查表。
    - 使用者投票介面：使用者可以透過一個簡單的網頁介面看到當期的菜色選項，並進行投票。
    - 投票結果回填：使用者的投票結果會被自動、準確地記錄回 Google Sheets 的指定工作表中。
    - 基本管理後台：管理者有一個基本介面，可以觸發匯入、建立調查表，並查看原始的投票結果數據。
  outOfScope:
    - AI 菜色重複性分析：根據週期判斷菜色重複性的功能。
    - 菜價爬蟲與智慧推薦：抓取外部菜價並提供智慧推薦的功能。
  nonFunctional:
    - 簡易性：所有使用者介面（投票頁、管理頁）必須直觀、易於操作。
    - 準確性：資料的匯入和投票結果的回填必須保證 100% 的準確性。
    - 回應速度：使用者投票介面的載入與提交，應在 3-5 秒內完成。

epicsAndStories:
  - epic: "MVP 核心功能：從菜單匯入到投票完成"
    stories:
      - id: Story-001
        story: "作為一個管理者，我想要在管理後台介面上傳一個特定格式的 Excel 檔案，以便我能快速地將現有的主菜與副菜清單匯入到 Google Sheets 資料庫中。"
        acceptanceCriteria:
          - "前提：管理者在管理後台頁面。"
          - "當：我選擇一個欄位包含「菜色名稱」和「分類」（例如 '主菜', '副菜'）的 Excel 檔案，並點擊「上傳」按鈕。"
          - "那麼：系統會解析該 Excel 檔案的內容。"
          - "而且：系統會先清空舊的「完整菜單資料庫」工作表。"
          - "而且：所有菜色及其對應的分類，會被逐行新增到 Google Sheets 的「完整菜單資料庫」工作表中。"
          - "而且：上傳成功後，頁面上會顯示「匯入成功，總共匯入 X 筆菜色資料」的成功訊息。"
          - "而且：如果檔案格式不符（如缺少必要欄位），頁面會顯示明確的錯誤訊息，且資料庫不會寫入任何資料。"
      - id: Story-002
        story: "作為一個管理者，我想要從已匯入的菜色清單中挑選菜色來建立一份新的意見調查表，以便我能發布給使用者進行投票。"
        acceptanceCriteria:
          - "前提：管理者在管理後台頁面，且「完整菜單資料庫」工作表中已有資料。"
          - "當：頁面從「完整菜單資料庫」讀取資料，並依「分類」將主菜與副菜分開列表顯示（附有複選框），我勾選完想要的菜色後，點擊「建立調查表」按鈕。"
          - "那麼：系統會清空「當期調查菜色」工作表中的舊資料。"
          - "而且：系統會將我所勾選的所有菜色（包含菜色名稱與分類）寫入「當期調查菜色」工作表中。"
          - "而且：頁面上會顯示成功訊息，例如「調查表建立成功！本次包含 X 道主菜，Y 道副菜。」"
          - "而且：頁面上會同時顯示一個可用於分享給使用者的「投票頁面連結」。"
          - "而且：如果我沒有選擇任何主菜或副菜就點擊按鈕，頁面應提示「請至少選擇一道主菜與一道副菜」。"
      - id: Story-003
        story: "作為一個使用者，我想要透過一個簡單的投票頁面，勾選我喜歡的所有主菜與副菜，以便管理者能了解我的偏好。"
        acceptanceCriteria:
          - "前提：使用者開啟了管理者分享的「投票頁面連結」。"
          - "當：頁面載入後，我看到了本次所有可選的主菜列表和副菜列表，每個菜名前都有一個複選框。"
          - "而且：我勾選了我想吃的 2 道主菜和 3 道副菜，並點擊「提交我的選擇」按鈕。"
          - "那麼：系統會將我的選擇（包含選擇的菜色名稱與一個時間戳記）記錄到 Google Sheets 的「投票記錄」工作表中。"
          - "而且：頁面會跳轉到一個感謝頁面，顯示「投票成功，感謝您的參與！」的訊息。"
          - "而且：如果我沒有勾選任何菜色就點擊提交，頁面會提示「請至少選擇一道您喜歡的菜色」。"
      - id: Story-004
        story: "作為一個管理者，我想要在管理後台查看一個簡單的投票結果統計，以便我能快速了解大家的菜色偏好，作為規劃菜單的依據。"
        acceptanceCriteria:
          - "前提：管理者在管理後台頁面，且「投票記錄」工作表中已有使用者投票資料。"
          - "當：我點擊「查看投票結果」按鈕。"
          - "那麼：系統會讀取並統計「投票記錄」工作表中的所有資料。"
          - "而且：頁面上會以列表形式，分別顯示主菜與副菜的投票排行榜。"
          - "而且：每個菜色名稱旁邊會顯示其獲得的總票數。"
          - "而且：列表會依照票數由高至低排序，讓最受歡迎的菜色一目了然。"

