storyId: "1.3"
blockedTask:
  taskId: "1.3-T2"
  description: "修改 getClinics 函式，增加 hasNightService 的篩選查詢邏輯"

reportTime: "2025-09-08T14:20:00Z"
blockerSummary: "Firestore 的查詢限制導致無法同時執行地理位置與布林值篩選。"

problemDescription: "嘗試在 `getClinics` 函式中加入 `where('hasNightService', '==', true)` 的篩選條件時，發現 Firestore 不支援在同一個查詢中對地理位置 (geo-query) 和其他非等式欄位同時進行篩選。這是一個底層資料庫的技術限制。"

impactAnalysis: "此問題將導致『夜間急診』篩選功能完全無法在後端實現。任務 1.3-T3 (前端串接) 和 1.3-T4 (E2E 測試) 也因此被完全阻塞。"

# 【核心變更】從選項列表，變為一個整合過的、有明確理由的建議方案
proposedSolution:
  title: "建議方案：客戶端篩選"
  description: "後端回傳所有附近的診所，由前端 App 自行過濾出 `hasNightService === true` 的診所。"
  # 【新增】整合 pros/cons，提出為何推薦此方案的理由
  rationale: "考量到目前正處於 MVP 開發階段，此方案能在不變更後端架構的前提下，最快速地交付功能以進行市場驗證，完全符合當前衝刺『快速交付核心功能』的目標。雖然長期來看有潛在效能問題，但這可以在後續迭代中，根據實際用戶數據再來決定是否投入成本進行架構優化。"